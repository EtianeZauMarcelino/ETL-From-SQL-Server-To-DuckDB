{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":""},{"location":"#diagramas","title":"Diagramas","text":"<pre><code>graph LR\n    hello --&gt; world\n    world --&gt; again\n    again --&gt; hello\n</code></pre>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"#reference","title":"Reference","text":""},{"location":"#etl","title":"ETL","text":""},{"location":"#extract-function","title":"Extract Function","text":"<p>Extracts data from a SQL Server database using the provided query and returns it as a pandas DataFrame.</p> <p>Parameters: - query (str): SQL query to extract data from the SQL Server database.</p> <p>Returns: - pd.DataFrame: DataFrame containing the extracted data.</p> <p>Raises: - Exception: If there's an error during the extraction process.</p> <p>Example:</p> <pre><code>data = extract_from_sql_server(\"SELECT * FROM TableName\")\n</code></pre> Source code in <code>app\\etl.py</code> <pre><code>def extract_from_sql_server(query: str) -&gt; pd.DataFrame:\n    \"\"\"\n    Extracts data from a SQL Server database using the provided query and returns it as a pandas DataFrame.\n\n    Parameters:\n    - query (str): SQL query to extract data from the SQL Server database.\n\n    Returns:\n    - pd.DataFrame: DataFrame containing the extracted data.\n\n    Raises:\n    - Exception: If there's an error during the extraction process.\n\n    Example:\n    ```\n    data = extract_from_sql_server(\"SELECT * FROM TableName\")\n    ```\n    \"\"\"\n    config = configuracoes()\n\n    try:\n        sql_server_Connection = pyodbc.connect(\n            f\"\"\"DRIVER={'SQL Server'};\n                SERVER={config['db_server']};\n                DATABASE={config['db_name']};\n                UID={config['db_user']};\n                PWD={config['db_pass']};\"\"\"\n        )\n\n        sql_server_cursor = sql_server_Connection.cursor()\n        print(\"SQLSERVER01 Server Connected\")\n\n        df_AdventureWorks = pd.read_sql(query, sql_server_Connection)\n\n        schema_AdventureWorks = pa.infer_schema(df_AdventureWorks)\n\n        with open(f'schema\\schema_AdventureWorks.py', 'w', encoding='utf-8') as schema_Adventure_Works:\n            schema_Adventure_Works.write(schema_AdventureWorks.to_script())\n\n    except Exception as error:\n        sql_server_Connection.close()\n        print(\"SQLSERVER01 Disconnected because of an error\")\n\n        print(f\"Error message: {error}\")\n\n    finally:\n        sql_server_Connection.close()\n\n    return df_AdventureWorks\n</code></pre>"}]}